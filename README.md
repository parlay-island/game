# Parlay Island Game

## Purpose
This repository contains all of the code for the Parlay Island game. This game is a platformer similar in style to Mario but also contains questions that are pulled from our backend API. The game is meant to help students learn and test themselves on the material from their class in a fun and interactive way. The students' results after playing a level are also sent to the backend API so then the teachers can track student progress (see the Parlay Island Frontend/Teacher Monitoring platform)

## Setup
This is a Unity application and is coded in C#

#### Unity Version
- When loading the project on Unity, esure that you are on version 2020.1.3f1
- Note: when loading in Unity in the Unity Editor select the Parlay directory not the app_ParlayIsland_game directory

#### Git LFS Setup Notes
- You just need to install git lfs, the gitattributes file is already generated so it will do everything it needs to automatically. You can find the instructions here: https://git-lfs.github.com/

There are no other dependencies as all Unity packages that are used are built in 

## Local Development

#### Running Locally
- the program is currently configured to run as a Unity WebGL game
- To run in the Unity Editor to get a preview:
    1. Once in Unity, go to Assets -> Scenes
    2. Open StartScreen.Unity
    3. Hit the play button in the Unity Editor
- To run as a WebGL, in the Unity Editor:
    1. Go to File -> Build Settings
    2. Make sure the Platform is WebGL and development build is not checked off
    3. Make sure the Scenes in Build includes:
        - Scenes/StartScreen
        - Scenes/LoginScreen       
        - Scenes/SignUpScreen
        - Scenes/ModeSelection
        - Scenes/Development
        - Scenes/RulesScreen
        - Scenes/RulesScreen2
    4. In any of the scenes listed in step 3 are not listed in the Scenes in Build, then drag them in from Scenes
    5. Click Build and Run
    6. Wait, the build most likely will take around 20 minutes

#### Running Tests Locally
This app uses Unity Testing and Nunit frameworks
1. With the Unity Editor open, go to Window -> General -> Test Runner
2. Click PlayMode
3. Click Run All

## Deployment Configuration
Since what is deployed is the Unity WebGL build, the variables have to be hard coded
- the following scenes all have references to the backend API
    - LoginScreen -> LoginManager -> PlayerRetriever
    - SignUpScreen -> AccountCreationManager -> PlayerRetriever
    - ModeSelection -> ModeRetriever -> ModeRetriever
    - ModeSelection -> Canvas -> LogoutButton -> PlayerRetriever
    - Development -> WebRetriever -> WebRetriever
- to update the aws deployment manually:
    1. for the steps for running a WebGL build Locally
    2. once the build is created, in app_ParlayIsland_game -> Parlay -> WebGL-Dist the build will be created
        - the build will contain directories called Build and TemplateData and a file called index.html
    3. These build components (Build and TemplateData directories and index.html) can be placed directly into aws
- or the deployment can be updated using the pipeline which is configured in app_ParlayIsland_game -> .gitlab-ci.yml 
   - currently it is set up so all pushes to master are deployed to the stage link (http://parlay-island-game-stage.s3-website.us-east-2.amazonaws.com/)
   - and you have to manually select to deploy to the prod link (http://parlay-island-game-prod.s3-website.us-east-2.amazonaws.com/)
   - in GitLab in Settings -> CI/CD -> variables will need to have variables for AWS_KEY_ID and AWS_KEY_SECRET
       - this can be generated by in aws going to the dropdown that has your email -> my security credentials -> Access keys for CLI, SDK, & API access -> create access key