stages:
  - test
  - build

unit-test:
  script: 
    - "/Applications/Unity/Hub/Editor/2020.1.3f1/Unity.app/Contents/MacOS/Unity \
    -batchmode \
    -projectPath=. \
    -runTests -testPlatform editmode \
    -logFile \
    -testResults ./unit-tests.xml"
    - "ls -a ."
    - "ls -a Parlay"
  stage: test
  artifacts:
    paths: 
      - 'unit-tests.xml'
      - !.git
  tags:
    - unity

build-webgl:
  script: 
    - "/Applications/Unity/Hub/Editor/2020.1.3f1/Unity.app/Contents/MacOS/Unity \
    -quit -batchmode -executeMethod WebGLBuilder.build -buildTarget WebGL -projectPath=."
    - "ls -a ."
    - "ls -a Parlay"
  stage: build
  tags:
    - unity
  artifacts:
    paths:
      - 'Parlay/WebGL-Dist/'
      - !.git
